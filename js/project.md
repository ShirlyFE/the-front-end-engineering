# 让一个对外的服务运作良好前期需要考虑问题

## 从专题模板生成系统到对外网用户提供可访问的专题，我所做的思考

### 专题系统生成完整专题片段发到外网服务器

要让这个过程通畅，需要：
1. 专题系统稳定，这就需要对专题系统服务进行守护，用PM2来做这件事
2. 专题系统涉及到数据库操作，这就需要考虑数据库的备份（增量备份、全量备份）和恢复、灾备（同城容灾和异地容灾，其实备份也是灾备的重要组成部分，一个完整的备份方案已经能够应付大多数系统计划内和计划外的宕机情况）、数据库的监控、数据库缓存和性能优化
3. 专题系统异常之后需要有报警，这就需要对专题系统服务进行监控
4. 外网服务器需要一个稳定的服务来接收我的专题
5. 如果专题对路由规则有要求可以允许自行设置，我考虑将路由规则保存在一个map文件中，由提供专题服务的程序去解析map

### 提供专题的外网服务器程序保证稳定可用需要：

1. 对服务进行守护，PM2来做
2. 对服务的良好监控
3. 并发性（注意进行缓存---html和DB两种皆可，比较倾向DB，备份恢复rebuild都比较容易）
4. 利用nginx做负载均衡、利用ssi来添加header和footer、进行资源缓存

### 链接发布系统

### 专题数据（html或者DB）rebuild
如果对外的专题是保存在DB里，那么数据rebuild就关注数据库数据丢失之后的rebuild，但是因为觉得静态资源已经足够，所以将专题资源直接保存在服务器磁盘，我的实现方案是在专题发布的时候先将专题push到git，git上的代码自动同步到专题服务器，这样的话

1. 需要全量rebuild的时候，直接从git上拉取，之后再对比专题系统已发布专题，如果有缺失再从专题系统重新生成一次发布

### 移动专题发布系统
利用接口还是怎样。。。。待确定

## 关于数据库

对于从来没有数据库开发经验的同学，在应用需要用到数据库的时候需要思考：

* 建库之前需要考虑什么


* 数据备份和恢复，良好数据库备份策略是什么
最新的完整数据库备份、最新的差异备份、所有事务日志备份

* 数据库日常监控需要监控那些内容？有哪些合适的监控软件可供使用

	1. 数据库实时运行状况监控和详细性能指标查询
	2. 数据库出现性能瓶颈，可提前预警
	3. 数据库响应时间、当前用户数、当前活跃用户数、数据库IO时延、SQL解析命中率、缓存命中率、死锁数、Buffer Cache大小、SQL执行速率、闪回日志写入速率、数据逻辑写速率、数据物理写速率、数据逻辑读速率、数据物理读速率、数据直接读速率、归档日志物理写速率、是否开启自动内存管理
	4. 异常触发及时预警
	5. 表空间的使用情况跟踪
	6. 段空间的使用情况跟踪
	7. 存储监控
	8. 性能监控
	9. 运行情况

* 数据库性能这个可以在以后的运维过程中慢慢积累经验


